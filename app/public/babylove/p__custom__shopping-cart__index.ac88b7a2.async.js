"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[0],{38738:function(os,A,a){a.r(A),a.d(A,{default:function(){return es}});var k=a(19632),O=a.n(k),w=a(97857),T=a.n(w),I=a(15009),g=a.n(I),M=a(99289),b=a.n(M),Z=a(12444),P=a.n(Z),B=a(72004),$=a.n(B),R=a(25098),m=a.n(R),z=a(31996),N=a.n(z),X=a(26037),D=a.n(X),Y=a(9783),y=a.n(Y),p=a(12695),S=a(67294),F=a(47866),L=a(42912),E=a(61544),U=a(6521),V=a(86592),W=a(90336),o=a(85893),H=function(j){N()(u,j);var x=D()(u);function u(f){return P()(this,u),x.call(this,f)}return $()(u,[{key:"render",value:function(){var s,t,n=this.props,e=n.goodsItem,i=n.selectGoodsCodes,r=n.selectGoods,l=n.changeCount,d=n.stopPropagation;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"baby-love-custom-shopping-cart-goods-select",onClick:d,children:(0,o.jsx)(p.XZ,{checked:i.includes(e.goodsCode),onChange:function(c){r(e.goodsCode,c)}})}),(0,o.jsxs)("div",{className:"baby-love-custom-shopping-cart-goods-picture",children:[(0,o.jsx)(p.Ee,{src:((s=e.pictures)===null||s===void 0||(t=s[0])===null||t===void 0?void 0:t.pictureUrl)||W,width:"100%",height:"100%",fit:"contain",style:{borderRadius:4}}),(0,o.jsx)("span",{className:"baby-love-custom-goods-list-item-inventory",children:e.goodsInventory<0?"\u5DF2\u552E\u7F44":"\u4EC5\u5269".concat(e.goodsInventory,"\u4EF6")})]}),(0,o.jsxs)("div",{className:"baby-love-custom-shopping-cart-goods-buy-info",children:[(0,o.jsx)("p",{className:"baby-love-custom-shopping-cart-goods-title",children:(0,o.jsx)(p.mH,{direction:"end",rows:2,content:e.goodsTitle})}),(0,o.jsxs)("div",{className:"baby-love-custom-shopping-cart-goods-price-count",children:[(0,o.jsxs)("span",{className:"baby-love-custom-shopping-cart-goods-price",children:["\xA5",e.goodsPrice]}),(0,o.jsxs)("span",{className:"baby-love-custom-shopping-cart-goods-count",children:[(0,o.jsx)("span",{onClick:function(c){l(c,e,--e.buyCount),d(c)},children:(0,o.jsx)(U.Z,{})}),(0,o.jsx)(p.II,{value:e.buyCount,type:"number",min:1,max:999,onClick:d,onChange:function(c){l(null,e,c)}}),(0,o.jsx)(V.Z,{onClick:function(c){d(c),l(c,e,++e.buyCount)}})]})]})]})]})}}]),u}(S.Component),J=H,K=function(j){N()(u,j);var x=D()(u);function u(f){return P()(this,u),x.call(this,f)}return $()(u,[{key:"render",value:function(){var s=this.props,t=s.goodsList,n=s.selectGoodsCodes,e=s.selectGoods,i=s.changeCount,r=s.stopPropagation,l=s.toGoodsDetails;return(0,o.jsx)(o.Fragment,{children:t!=null&&t.length?(0,o.jsx)("ul",{children:t.map(function(d){return(0,o.jsx)("li",{className:"baby-love-custom-shopping-cart-goods-item",onClick:function(){return l(d.goodsCode)},children:(0,o.jsx)(J,{goodsItem:d,selectGoodsCodes:n,selectGoods:e,changeCount:i,stopPropagation:r})},d.goodsCode)})}):(0,o.jsx)("div",{className:"baby-love-custom-shopping-cart-empty",children:"\u6682\u65E0\u6570\u636E"})})}}]),u}(S.Component),Q=K,q=function(j){N()(u,j);var x=D()(u);function u(f){return P()(this,u),x.call(this,f)}return $()(u,[{key:"render",value:function(){var s=this.props,t=s.totalPrice,n=s.goodsList,e=s.selectGoodsCodes,i=s.selectAllGoods,r=s.remove,l=s.buy;return(0,o.jsxs)("div",{className:"baby-love-custom-shopping-cart-goods-order",children:[(0,o.jsxs)("span",{className:"baby-love-custom-shopping-cart-goods-order-price",children:[(0,o.jsx)("span",{className:"baby-love-custom-shopping-cart-goods-select-all",children:(0,o.jsx)(p.XZ,{checked:(e==null?void 0:e.length)!==0&&(e==null?void 0:e.length)===n.length,onChange:i})}),(0,o.jsxs)("span",{className:"baby-love-custom-shopping-cart-goods-total-price",children:["\u5408\u8BA1\uFF1A\xA5",t.toFixed(2)]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)(p.zx,{className:"baby-love-custom-shopping-cart-goods-remove-btn",color:"default",onClick:r,children:"\u5220\u9664"}),(0,o.jsx)(p.zx,{color:"primary",onClick:l,children:"\u4E0B\u5355"})]})]})}}]),u}(S.Component),_=q,ss=function(j){N()(u,j);var x=D()(u);function u(f){var s;return P()(this,u),s=x.call(this,f),y()(m()(s),"initData",b()(g()().mark(function t(){return g()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.setShoppingCartCode();case 2:return e.next=4,s.getGoodsList();case 4:case"end":return e.stop()}},t)}))),y()(m()(s),"stopPropagation",function(t){return t&&t.stopPropagation(),!1}),y()(m()(s),"setShoppingCartCode",b()(g()().mark(function t(){return g()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,E.YX)();case 2:s.shoppingCartCode=e.sent;case 3:case"end":return e.stop()}},t)}))),y()(m()(s),"getGoodsList",b()(g()().mark(function t(){var n,e,i,r;return g()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,L.Z.get(F.gR,{params:{shoppingCartCode:s.shoppingCartCode}});case 2:n=d.sent,e=n.data,i={isShowLoading:!1},e&&Array.isArray(e.goods)&&(r=[],e.goods.forEach(function(h){h.selected&&r.push(h.goodsCode)}),i=T()(T()({},i),{},{goodsList:e.goods,selectGoodsCodes:r})),s.setState(i,s.setTotalPrice);case 7:case"end":return d.stop()}},t)}))),y()(m()(s),"changeCount",function(){var t=b()(g()().mark(function n(e,i,r){var l,d,h,c,C,v;return g()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return s.stopPropagation(e),r=r<1?1:r,G.next=4,L.Z.post(F.Al,{shoppingCartCode:s.shoppingCartCode,goodsCode:i.goodsCode,buyCount:r});case 4:if(l=G.sent,d=l.success,h=l.data,c=l.errCode,d){G.next=10;break}return G.abrupt("return");case 10:c==="OUT_OF_STOCK"&&(p.FN.show({content:"\u8BE5\u5546\u54C1\u5E93\u5B58\u4E0D\u8DB3"}),r=h),C=s.state.goodsList,v=0;case 13:if(!(v<C.length)){G.next=21;break}if(C[v].goodsCode!==i.goodsCode){G.next=18;break}return C[v].buyCount=r<1?1:r,s.setState({goodsList:O()(C)}),G.abrupt("break",21);case 18:v++,G.next=13;break;case 21:s.setTotalPrice();case 22:case"end":return G.stop()}},n)}));return function(n,e,i){return t.apply(this,arguments)}}()),y()(m()(s),"toGoodsDetails",function(t){(0,E.WF)("/goods/details?goodsCode="+t)}),y()(m()(s),"setTotalPrice",function(){var t=s.state,n=t.selectGoodsCodes,e=t.goodsList,i=0;e.forEach(function(r){n.includes(r.goodsCode)&&(i+=r.goodsPrice*r.buyCount)}),s.setState({totalPrice:i})}),y()(m()(s),"selectGoods",function(){var t=b()(g()().mark(function n(e,i){var r,l,d,h,c;return g()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return r=s.state.selectGoodsCodes,v.next=3,L.Z.post(F.M1,{shoppingCartCode:s.shoppingCartCode,goodsCodes:[e],selected:i?1:0});case 3:if(l=v.sent,d=l.code,h=l.message,c=l.success,c){v.next=9;break}return v.abrupt("return");case 9:d==="SOME_GOODS_EMPTY"&&p.FN.show({content:h||"\u5546\u54C1\u5E93\u5B58\u4E0D\u8DB3"}),s.getGoodsList(s.shoppingCartCode);case 11:case"end":return v.stop()}},n)}));return function(n,e){return t.apply(this,arguments)}}()),y()(m()(s),"selectAllGoods",function(){var t=b()(g()().mark(function n(e){var i,r,l,d,h;return g()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return i=e?s.state.goodsList.map(function(v){return v.goodsCode}):[],C.next=3,L.Z.post(F.M1,{shoppingCartCode:s.shoppingCartCode,goodsCodes:i,selected:e?1:0});case 3:if(r=C.sent,l=r.code,d=r.success,h=r.message,d){C.next=9;break}return C.abrupt("return");case 9:l==="SOME_GOODS_EMPTY"&&p.FN.show({content:h||"\u5546\u54C1\u5E93\u5B58\u4E0D\u8DB3"}),s.getGoodsList(s.shoppingCartCode);case 11:case"end":return C.stop()}},n)}));return function(n){return t.apply(this,arguments)}}()),y()(m()(s),"remove",b()(g()().mark(function t(){var n,e,i,r,l,d;return g()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(n=s.state,e=n.selectGoodsCodes,i=n.goodsList,e.length){c.next=3;break}return c.abrupt("return",p.FN.show({content:"\u8BF7\u5148\u9009\u62E9\u5546\u54C1"}));case 3:return c.next=5,p.Vq.confirm({content:"\u786E\u5B9A\u5220\u9664\u6240\u9009\u5546\u54C1\u5417\uFF1F"});case 5:if(r=c.sent,r){c.next=8;break}return c.abrupt("return");case 8:return c.next=10,L.Z.post(F.rx,{shoppingCartCode:s.shoppingCartCode,goodsCodes:e});case 10:if(l=c.sent,d=l.success,d){c.next=14;break}return c.abrupt("return");case 14:p.FN.show({icon:"success",content:"\u5220\u9664\u6210\u529F\uFF01"}),i=i.filter(function(C){return!e.includes(C.goodsCode)}),s.setState({goodsList:i,selectGoodsCodes:[]});case 17:case"end":return c.stop()}},t)}))),y()(m()(s),"buy",function(){var t=s.state.selectGoodsCodes;if(!t.length)return p.FN.show({content:"\u8BF7\u5148\u9009\u62E9\u5546\u54C1"});p.Vq.confirm({image:"/public/pictures/WX20230519-011105.png",title:"\u4E13\u5C5E\u5BA2\u670D\u4E0B\u5355",content:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("p",{children:"1\u3001\u957F\u6309\u4FDD\u5B58\u56FE\u7247\u6DFB\u52A0\u4E13\u5C5E\u5BA2\u670D\u5FAE\u4FE1\uFF1B"}),(0,o.jsx)("p",{children:"2\u3001\u590D\u5236\u8D2D\u7269\u8F66\u5730\u5740\u53D1\u7ED9\u4E13\u5C5E\u5BA2\u670D\u4E0B\u5355\u3002"}),(0,o.jsxs)("p",{children:["\u8D2D\u7269\u8F66\u5730\u5740\uFF1A",location.href]})]}),confirmText:"\u590D\u5236\u5730\u5740",onConfirm:function(){var n=b()(g()().mark(function i(){var r;return g()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:r=(0,E.JG)(location.href),r?setTimeout(function(){p.FN.show({content:"\u590D\u5236\u6210\u529F",icon:"success"})},300):p.FN.show({content:"\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236",icon:"fail"});case 2:case"end":return d.stop()}},i)}));function e(){return n.apply(this,arguments)}return e}()})}),s.state={goodsList:[],selectGoodsCodes:[],totalPrice:0,isShowLoading:!0},s.shoppingCartCode=null,s}return $()(u,[{key:"componentDidMount",value:function(){this.initData()}},{key:"render",value:function(){var s=this.state,t=s.totalPrice,n=s.selectGoodsCodes,e=s.goodsList,i=s.isShowLoading;return(0,o.jsx)("div",{className:"baby-love-custom-shopping-cart",children:i?(0,o.jsx)(p.k_,{color:"primary"}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Q,{goodsList:e,selectGoodsCodes:n,selectGoods:this.selectGoods,changeCount:this.changeCount,stopPropagation:this.stopPropagation,toGoodsDetails:this.toGoodsDetails}),(0,o.jsx)(_,{totalPrice:t,goodsList:e,selectGoodsCodes:n,selectAllGoods:this.selectAllGoods,remove:this.remove,buy:this.buy})]})})}}]),u}(S.Component),es=ss}}]);
